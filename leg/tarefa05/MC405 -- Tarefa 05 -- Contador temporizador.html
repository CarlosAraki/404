<!DOCTYPE html>
<!-- saved from url=(0054)https://susy.ic.unicamp.br:9999/mc404abe/05/enunc.html -->
<html lang="pt"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
     <title>MC405 -- Tarefa 05 -- Contador temporizador</title>
  </head>
<body>	
<h1>MC405 -- Tarefa 05 -- Contador temporizador</h1>

<p>Nesta tarefa você deve construir um contador (de tempo) decrescente, que pode ser usado como um temporizador. Para simplificar,
o contador vai ter apenas um dígito decimal.

</p><p>O contador vai ser composto por um teclado e um por um display de
sete segmentos. O usuário pode escolher um valor (entre 0 e 9) usando
o teclado. O contador mostra o valor escolhido pelo usuário e inicia a
contagem regressiva, atualizando o valor no display a cada segundo,
até o display mostrar o valor zero.  Como veremos, o contador não vai
marcar o tempo de forma precisa; veremos no futuro como implementar um
temporizador mais preciso.

</p><p>O contador deve iniciar mostrando o valor zero. Se o usuário
digitar a tecla 3, o contador deve mostrar o valor 3 no display,
esperar um segundo (mais ou menos!), mostrar o valor 2 no display,
esperar um segundo, mostrar o valor 1, esperar um segundo, mostrar
o valor 0 e esperar pela próxima entrada do usuário.

</p><p>
<i>Esta tarefa não pode ser feita no Cloud 9, pois este não tem suporte para elementos gráficos como o teclado!</i>

</p><p>
</p><h3>Parte A</h3>
<p>Escreva uma rotina de tratamento de interrupção
do teclado, que simplesmente atualize o valor de uma variável
de nome <tt>contador</tt> com o valor da tecla pressionada pelo usuário. 

</p><p><i>Dica: tem uma rotina de tratamento do teclado nas notas de aula!</i>

</p><h3>Parte B</h3>
<p>Escreva um procedimento de nome <tt>mostra</tt>, com um parâmetro (um valor entre 0 e 9),
passado pelo registrador r0
e mostra esse valor no display de sete segmentos.

</p><h3>Parte C</h3>
<p>Escreva um procedimento de nome <tt>decrementa</tt> que recebe em
r0 um valor entre 0 e 9, mostra esse valor inicial, espera um certo
tempo, decrementa e mostra o novo valor, espera um certo tempo,
decrementa e mostra o novo valor, etc, até que o valor seja zero, A
espera deve ser feita com um "loop de espera", que apenas gasta tempo,
por exemplo inicializando um registrador qualquer com um valor
específico e decrementando o valor desse registrador até que seja
igual a zero.

</p><p>Você deve ler o valor específico usado na espera de uma variável de nome
<tt>intervalo</tt>. (Obs.: no meu laptop, para conseguir um tempo de mais ou menos
um segundo usando um loop simples como o descrito acima, essa variável deve ser
inicializada com o valor <tt>0x400000</tt>. No Susy, o valor dessa variável vai ser
bem mais baixo, para executar mais rápido, já que esse loop de espera apenas gasta tempo, mas para
verificar visualmente ele tem que ser alto).



</p><p>O dispositivo teclado deve usar as portas 0x80 (porta de dados) e
0x81 (porta de estado), e deve usar a interrupção de tipo 0x10. Você
deve <i>obrigatoriamente</i> usar interrupções, caso contrário sua
nota será drasticamente reduzida! Note que, usando interrupções, você
não precisa consultar a porta de estado do teclado, a não ser que
queira tratar erros de atropelamento (mas não precisa!).

</p><p>Por exemplo, uma descrição possível do dispositivo teclado para o simulador é:

</p><pre>%keyboard Entrada
0x80 0x81 0x10
</pre>

e uma descrição possível do display de sete segmentos é 

<pre>%7segs  Contador
0x20
</pre>


<h3>Parte D</h3>
<p>Escreva um programa para construir o Contador temporizador, usando as funções definidas acima.


</p><p>
Seu programa deve executar continuamente, efetuando a temporização com o valor inicial digitado pelo usuário no teclado. 
<i>Seu programa deve escrever no display de sete segmentos o menor número de valores possíveis para que o temporizador
esteja correto.</i> Em outras palavras, você não deve escrever no display o valor que já está no display. Por exemplo,
se o display mostra o valor 0, você não deve escrever o valor correspondente a 0 novamente na porta do display.

</p><p>
A primeira instrução a ser executada pelo seu programa deve estar no endereço de
rótulo <tt>init</tt>. Lembre que você tem que reservar espaço para a pilha, inicializar o registrador apontador de pilha (sp),
inicializar o vetor de interrupções e habilitar interrupções (com a instrução 'sti').

</p><p>
Por razões de testes no Susy, você não deve utilizar a memória abaixo do endereço 0x1000.

</p><h3>Simplificações</h3>
<p>Você pode assumir que:
</p><ul>
<li>O usuário não vai pressionar qualquer tecla enquanto o temporizador estiver contando. 
</li><li>O usuário sempre vai digitar apenas um  dígito, e esperar o temporizador contar.
</li><li>O usuário não vai pressionar as teclas '*' ou '#'.
</li></ul>

<h3>Submissão</h3> Você deve submeter o seu programa-fonte em
linguagem de montagem LEG. O arquivo de submissão deve
chamar-se <tt>tarefa05.s</tt>.  O número máximo de submissões no Susy
é 10. Teste exaustivamente seu programa localmente, usando o simulador
LEG; não use o Susy como ferramenta de teste!

<h3>Peso</h3>
O peso deste lab na composição da nota é 1.


	
	

</body></html>